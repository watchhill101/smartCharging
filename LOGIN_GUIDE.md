# 智能充电系统 - 登录功能指南

## 🎯 功能概述

本系统实现了完整的用户登录功能，包括滑块验证、JWT认证、用户状态管理等特性。

## 🔐 登录流程

### 1. 前端登录流程
1. 用户输入用户名/密码
2. 完成滑块验证（必须）
3. 提交登录请求
4. 保存用户信息和令牌
5. 跳转到首页

### 2. 后端验证流程
1. 接收登录请求
2. 验证滑块令牌
3. 查找用户信息
4. 验证用户凭据
5. 生成JWT令牌
6. 返回用户信息

## 🧪 测试账号

以下是可用的测试账号：

| 用户名 | 密码 | 说明 |
|--------|------|------|
| admin | 123456 | 管理员账号 |
| 13800138000 | 123456 | 手机号登录 |
| test | password | 测试账号 |

## 📱 使用方法

### 登录步骤：
1. 在首页点击"立即登录"
2. 输入用户名和密码（使用上述测试账号）
3. 拖动滑块完成安全验证
4. 点击"登录"按钮
5. 登录成功后自动跳转到首页

### 登录后功能：
- 查看用户信息（昵称、手机号、余额等）
- 查看账户余额（演示金额：¥100）
- 查看验证等级
- 退出登录

## 🛠️ 技术实现

### 前端技术：
- **滑块验证**：自定义滑块组件，支持拖拽验证
- **状态管理**：React Hooks管理登录状态
- **本地存储**：Taro存储API保存用户信息
- **错误处理**：完整的错误提示和处理机制

### 后端技术：
- **JWT认证**：生成和验证JWT令牌
- **密码验证**：bcrypt加密验证（演示模式）
- **用户查询**：MongoDB数据库用户查询
- **安全验证**：滑块令牌验证机制

## 🔒 安全特性

1. **滑块验证**：防止机器人自动登录
2. **JWT令牌**：无状态认证机制
3. **刷新令牌**：支持令牌自动刷新
4. **密码加密**：bcrypt加密存储
5. **错误限制**：避免暴露敏感信息

## 🚀 快速开始

### 启动后端：
```bash
cd backEnd
npm install
npm run dev
```

### 启动前端：
```bash
cd frontEnd
npm install
npm run dev:weapp
```

### 测试登录：
1. 打开微信开发者工具
2. 导入前端项目
3. 在首页点击登录
4. 使用测试账号登录

## 📝 注意事项

1. **演示模式**：当前使用固定的测试账号进行演示
2. **数据库连接**：确保MongoDB服务正在运行
3. **端口配置**：后端默认运行在8080端口
4. **CORS设置**：已配置跨域访问支持

## 🔄 登录状态管理

- **自动检查**：应用启动时自动检查登录状态
- **状态同步**：页面切换时同步登录状态
- **令牌刷新**：支持自动刷新过期令牌
- **安全退出**：完整清理本地存储数据

## 🐛 常见问题

### Q: 滑块验证失败怎么办？
A: 请确保完整拖动滑块到目标位置，如果仍然失败，点击重试按钮。

### Q: 登录后看不到用户信息？
A: 请检查网络连接和后端服务是否正常运行。

### Q: 如何添加新的测试账号？
A: 在 `backEnd/src/routes/auth.ts` 的 `validCredentials` 数组中添加新的用户名和密码。

## 📞 技术支持

如果在使用过程中遇到问题，请检查：
1. 后端服务是否正常启动
2. 数据库连接是否正常
3. 前端API配置是否正确
4. 控制台是否有错误信息

---

**注意**：这是一个演示系统，实际生产环境中需要完善密码存储、用户注册等功能。 